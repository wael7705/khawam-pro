# ูุธุงู ุงูุฅุดุนุงุฑุงุช ูุงูุชูุจููุงุช - Khawam Pro

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุจูุงุก ูุธุงู ุฅุดุนุงุฑุงุช ูุชูุงูู ูุฑุณู ุฅุดุนุงุฑุงุช ูุชูุจููุงุช ุตูุชูุฉ ุนูุฏ ุชุฃููุฏ ุงูุทูุจ ููุตููู ุฅูู ุชุจููุจ ุงูุทูุจุงุช ูู ููุญุฉ ุงูุชุญูู.

## ุงูููููุงุช ุงูุฑุฆูุณูุฉ

### 1. Backend - WebSocket Notifications

**ุงููููุงุช:**
- `backend/notifications.py` - ูุฏูุฑ ุงูุฅุดุนุงุฑุงุช
- `backend/routers/notifications.py` - WebSocket endpoint
- `backend/routers/orders.py` - ุจุซ ุงูุฅุดุนุงุฑุงุช ุนูุฏ ุฅูุดุงุก ุงูุทูุจ

**ููู ูุนูู:**
- ุนูุฏ ุฅูุดุงุก ุทูุจ ุฌุฏูุฏุ ูุชู ุจุซ ุฅุดุนุงุฑ ุนุจุฑ WebSocket ูุฌููุน ุงูููุธููู ุงููุชุตููู
- ูุณุชุฎุฏู `OrderNotificationManager` ูุฅุฏุงุฑุฉ ุงูุงุชุตุงูุงุช

### 2. Frontend - ูุธุงู ุงูุฅุดุนุงุฑุงุช

**ุงููููุงุช:**
- `frontend/src/hooks/useOrderNotifications.ts` - Hook ููุฅุดุนุงุฑุงุช
- `frontend/src/hooks/useNotificationSound.ts` - Hook ููุฃุตูุงุช
- `frontend/src/pages/Dashboard/OrdersManagement.tsx` - ุงุณุชุฎุฏุงู ุงููุธุงู
- `frontend/public/sw.js` - Service Worker

**ุงูููุฒุงุช:**
- โ ุฅุดุนุงุฑุงุช ุงููุชุตูุญ (Browser Notifications)
- โ ุชูุจููุงุช ุตูุชูุฉ
- โ WebSocket ููุงุชุตุงู ุงูููุฑู
- โ Service Worker ููุฅุดุนุงุฑุงุช ุงูุฎูููุฉ
- โ ูุดู ุฐูู ููุทูุจุงุช ุงูุฌุฏูุฏุฉ (ุชุฌูุจ ุงูุชูุฑุงุฑ)

## ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุทูุจ ุฅุฐู ุงูุฅุดุนุงุฑุงุช

ุงููุธุงู ูุทูุจ ุงูุฅุฐู ุชููุงุฆูุงู ุนูุฏ ูุชุญ ููุญุฉ ุงูุชุญูู:

```typescript
// ูู useOrderNotifications.ts
useEffect(() => {
  if ('Notification' in window && Notification.permission === 'default') {
    Notification.requestPermission().then(setNotificationPermission)
  }
}, [])
```

### 2. ุงูุงุชุตุงู ุจู WebSocket

ูุชู ุงูุงุชุตุงู ุชููุงุฆูุงู ุนูุฏ ูุชุญ ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุทูุจุงุช:

```typescript
const { notifications, isConnected } = useOrderNotifications({
  onNotificationClick: (orderId) => navigate(`/dashboard/orders/${orderId}`),
  enableDesktopNotifications: true,
  enableSoundNotifications: true,
})
```

### 3. ูุดู ุงูุทูุจุงุช ุงูุฌุฏูุฏุฉ

ุงููุธุงู ููุชุดู ุงูุทูุจุงุช ุงูุฌุฏูุฏุฉ ุชููุงุฆูุงู:

```typescript
useEffect(() => {
  const currentOrderIds = new Set(orders.map((o) => o.id))
  const newOrderIds = new Set<number>()

  orders.forEach((order) => {
    if (!knownOrderIdsRef.current.has(order.id)) {
      newOrderIds.add(order.id)
    }
  })

  if (newOrderIds.size > 0) {
    // ุฅุธูุงุฑ ุฅุดุนุงุฑ ููู ุทูุจ ุฌุฏูุฏ
    playSound('new_order')
    showBrowserNotification(...)
  }
}, [orders])
```

## ุฃููุงุน ุงูุฅุดุนุงุฑุงุช

### 1. ุฅุดุนุงุฑุงุช ุงููุชุตูุญ

- **ุงูุนููุงู**: "๐ ุทูุจ ุฌุฏูุฏ"
- **ุงููุญุชูู**: ุฑูู ุงูุทูุจ ูุงุณู ุงูุนููู
- **ุงูุฃููููุฉ**: ุตูุฑุฉ ุงูุทูุจ ุฃู logo.png
- **ุงูุฅุฌุฑุงุก**: ุงูููุฑ ููุชุญ ุตูุญุฉ ุงูุทูุจ

### 2. ุงูุชูุจููุงุช ุงูุตูุชูุฉ

- **ุตูุช ุงูุทูุจ ุงูุฌุฏูุฏ**: ุชุฑุฏุฏ 800Hzุ ูุฏุฉ 0.5 ุซุงููุฉ
- **ุตูุช ุงูุชุญุฐูุฑ**: ุชุฑุฏุฏ 600Hzุ ูุฏุฉ 0.8 ุซุงููุฉ
- **ุตูุช ุงููุฌุงุญ**: ุชุฑุฏุฏ 1000Hzุ ูุฏุฉ 0.3 ุซุงููุฉ

### 3. WebSocket Notifications

- **ุงูุญุฏุซ**: `order_created`
- **ุงูุจูุงูุงุช**: ูุนูููุงุช ุงูุทูุจ ุงููุงููุฉ
- **ุงูุงุชุตุงู**: ุชููุงุฆู ุนูุฏ ูุชุญ ููุญุฉ ุงูุชุญูู

## ุฅุตูุงุญ ูุดููุฉ 502 Bad Gateway

ุชู ุฅุตูุงุญ ุงููุดููุฉ ูู:

### 1. Dockerfile
- โ ุฒูุงุฏุฉ `start-period` ูู health check ุฅูู 60 ุซุงููุฉ
- โ ุงุณุชุฎุฏุงู shell form ููู CMD ูุถูุงู ุชูุณูุน ุงููุชุบูุฑุงุช

### 2. start.sh
- โ ุฅุถุงูุฉ ูุญุต ูุฌูุฏ `main.py`
- โ ุฅุถุงูุฉ `--access-log` ูู uvicorn
- โ ุฅุถุงูุฉ `--timeout-graceful-shutdown`

## Service Worker

**ุงูููู**: `frontend/public/sw.js`

**ุงูููุฒุงุช:**
- โ Cache ููุตูุญุงุช ุงูุฃุณุงุณูุฉ
- โ Push notifications
- โ Background sync
- โ Notification click handling

**ุงูุชุณุฌูู**: ูุชู ุชููุงุฆูุงู ูู `main.tsx`

## ูุคุดุฑ ุงูุงุชุตุงู

ูุธูุฑ ูุคุดุฑ ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ููุถุญ ุญุงูุฉ ุงูุงุชุตุงู:
- ๐ข **ุฃุฎุถุฑ**: ุงูุงุชุตุงู ูุดุท
- ๐ด **ุฃุญูุฑ**: ุงูุงุชุตุงู ูููุทุน (ุณูุชู ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุชููุงุฆูุงู)

## ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุงูุชููุงุฆู

ูู ุญุงูุฉ ุงููุทุงุน ุงูุงุชุตุงู:
- ูุชู ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุจุนุฏ 3 ุซูุงู
- ูุชู ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุญุชู ูุฌุงุญ ุงูุงุชุตุงู

## ุชุฌูุจ ุงูุฅุดุนุงุฑุงุช ุงูููุฑุฑุฉ

ุงููุธุงู ูุณุชุฎุฏู:
- `knownOrderIdsRef` ูุชุชุจุน ุงูุทูุจุงุช ุงููุนุฑููุฉ
- `tag` ูู ุฅุดุนุงุฑุงุช ุงููุชุตูุญ ูููุน ุงูุชูุฑุงุฑ
- ูุญุต ุนูุฏ ุงูุชุญููู ุงูุฃูู ูุชุฌูุจ ุฅุดุนุงุฑุงุช ุงูุทูุจุงุช ุงููุฏููุฉ

## ุงูุงุฎุชุจุงุฑ

1. **ูุชุญ ููุญุฉ ุงูุชุญูู**: ูุฌุจ ุฃู ูุธูุฑ ูุคุดุฑ ุงูุงุชุตุงู ุงูุฃุฎุถุฑ
2. **ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ**: ูุฌุจ ุฃู ูุธูุฑ ุฅุดุนุงุฑ ูุตูุช ุชูุจูู
3. **ุงูููุฑ ุนูู ุงูุฅุดุนุงุฑ**: ูุฌุจ ุฃู ููุชุญ ุตูุญุฉ ุงูุทูุจ
4. **ุฅุบูุงู ุงููุชุตูุญ**: Service Worker ูุณุชูุฑ ูู ุงูุนูู

## ููุงุญุธุงุช ูููุฉ

- โ ุงูุฅุดุนุงุฑุงุช ุชุนูู ููุท ููููุธููู ูุงููุฏูุฑูู
- โ ูุฌุจ ููุญ ุฅุฐู ุงูุฅุดุนุงุฑุงุช ูู ุงููุชุตูุญ
- โ WebSocket ูุชุทูุจ token ุตุงูุญ
- โ Service Worker ูุญุชุงุฌ HTTPS ูู ุงูุฅูุชุงุฌ

## ุงููููุงุช ุงููุถุงูุฉ/ุงููุนุฏูุฉ

### ูููุงุช ุฌุฏูุฏุฉ:
- `frontend/src/hooks/useOrderNotifications.ts`
- `frontend/src/hooks/useNotificationSound.ts`
- `frontend/public/sw.js`
- `NOTIFICATIONS_SYSTEM.md`

### ูููุงุช ูุนุฏูุฉ:
- `backend/Dockerfile` - ุฅุตูุงุญ 502
- `backend/start.sh` - ุชุญุณููุงุช ุงูุจุฏุก
- `frontend/src/pages/Dashboard/OrdersManagement.tsx` - ุฅุถุงูุฉ ุงูุฅุดุนุงุฑุงุช
- `frontend/src/main.tsx` - ุชุณุฌูู Service Worker

## ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. โ ูุดุฑ ุงูุชุบููุฑุงุช
2. โ ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช
3. โ ุงูุชุญูู ูู WebSocket
4. โ ุงูุชุญูู ูู Service Worker

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก**: 2024  
**ุงูุฅุตุฏุงุฑ**: 1.0.0  
**ุงููุดุฑูุน**: Khawam Pro Printing Services

